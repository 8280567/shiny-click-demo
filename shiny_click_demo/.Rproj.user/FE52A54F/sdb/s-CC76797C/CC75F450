{
    "contents" : "library(shiny)\nlibrary(ggplot2)\nlibrary(ggthemes)\nsource(\"myMethods.R\", encoding = \"utf-8\")\n\nshinyServer(function(input, output, session) {\noutput$pplot1 <- renderText({  ## click event\n    xy_str <- function(e) {\n        if (is.null(e)) return(\"NULL\\n\")\n        print(paste(\"X:\",sep = \"\", e$x))\n        print(paste(\"Y:\",sep = \"\", e$y))\n\n        bar <- pointAtBar(myPixel1, e$x, e$y)\n        if (is.null(bar)) return(\"NULL\\n\")  ## if the column is not clicked,then return.\n        print(bar)\n        session$sendCustomMessage(\"openMenu\", message = list(divid = 'myMenu1', b = 'text', event = e))\n    }\n    xy_range_str <- function(e) {\n        if (is.null(e)) return(\"NULL\\n\")\n        paste0(\"xmin=\", round(e$xmin, 1), \" xmax=\", round(e$xmax, 1),\n               \" ymin=\", round(e$ymin, 1), \" ymax=\", round(e$ymax, 1))\n    }\n    xy_str(input$plot_click1)\n    paste(\"You can see more information here：http://blog.csdn.net/Bone_ACE/article/details/48005855\")\n})\n\n\noutput$pplot2 <- renderText({  ## click event\n    xy_str <- function(e) {\n        if (is.null(e)) return(\"NULL\\n\")\n        print(paste(\"X:\", sep = \"\", e$x))\n        print(paste(\"Y:\", sep = \"\", e$y))\n\n        line <- pointAtLine(myPixel2,e$x,e$y)\n        if (is.null(line)) return(\"NULL\\n\")   ## if the line is not clicked,then return.\n        print(line)\n        session$sendCustomMessage(\"openMenu\", message = list(divid = 'myMenu2', b = 'text', event = e))\n    }\n    xy_range_str <- function(e) {\n        if (is.null(e)) return(\"NULL\\n\")\n        paste0(\"xmin=\", round(e$xmin, 1), \" xmax=\", round(e$xmax, 1),\n               \" ymin=\", round(e$ymin, 1), \" ymax=\", round(e$ymax, 1))\n    }\n    xy_str(input$plot_click2)\n    paste(\"You can see more information here：http://blog.csdn.net/Bone_ACE/article/details/48005855\")\n})\n\n\noutput$pplot3 <- renderText({  ## click event\n    xy_str <- function(e) {\n        if (is.null(e)) return(\"NULL\\n\")\n        print(paste(\"X:\", sep = \"\", e$x))\n        print(paste(\"Y:\", sep = \"\", e$y))\n\n        pie <- pointAtPie(myAngle1,e$x,e$y)\n        if (is.null(pie)) return(\"NULL\\n\")   ## if the fan is not clicked,then return.\n        print(pie)\n        session$sendCustomMessage(\"openMenu\", message = list(divid = 'myMenu3', b = 'text', event = e))\n    }\n    xy_range_str <- function(e) {\n        if (is.null(e)) return(\"NULL\\n\")\n        paste0(\"xmin=\", round(e$xmin, 1), \" xmax=\", round(e$xmax, 1),\n               \" ymin=\", round(e$ymin, 1), \" ymax=\", round(e$ymax, 1))\n    }\n    xy_str(input$plot_click3)\n    paste(\"You can see more information here：http://blog.csdn.net/Bone_ACE/article/details/48005855\")\n})\n\n\noutput$pplot4 <- renderText({  ## click event\n    xy_str <- function(e) {\n        if (is.null(e)) return(\"NULL\\n\")\n        print(paste(\"X:\", sep = \"\", e$x))\n        print(paste(\"Y:\", sep = \"\", e$y))\n\n        rose <- pointAtPie(myAngle2,e$x,e$y)\n        if (is.null(rose)) return(\"NULL\\n\")   ## if the fan is not clicked,then return.\n        print(rose)\n        session$sendCustomMessage(\"openMenu\", message = list(divid = 'myMenu4', b = 'text', event = e))\n    }\n    xy_range_str <- function(e) {\n        if (is.null(e)) return(\"NULL\\n\")\n        paste0(\"xmin=\", round(e$xmin, 1), \" xmax=\", round(e$xmax, 1),\n               \" ymin=\", round(e$ymin, 1), \" ymax=\", round(e$ymax, 1))\n    }\n    xy_str(input$plot_click4)\n    paste(\"You can see more information here：http://blog.csdn.net/Bone_ACE/article/details/48005855\")\n})\n\n\n\n\n\n\n\n\noutput$mainBar <- renderImage({\n  dt = data.frame(obj = c('A','D','B','E','C'), val = c(2,15,6,9,7))\n  p = ggplot(dt, aes(x = obj, y = val, fill = obj, group = factor(1))) +   ## Here is your plot\n      geom_bar(stat = \"identity\", width = 0.5) +\n      theme_economist()\n  myPixel1 <<- Getbar(p)   ## Transforming the centimeter coordinates into pixel coordinates.HASHP is a global variable.\n  ggsave(\"img/mainPlot1.png\", width = 9, height = 4.6, dpi = 300)   ## Save your ggplot2 plot as a picture.\n\n  filename <- normalizePath(file.path('./img', paste('mainPlot1', '.png', sep = '')))\n  list(src = filename\n       ,width = 800\n       ,height = 400\n  )\n}, deleteFile = FALSE)\n\n\noutput$mainLine <- renderImage({\n    dt = data.frame(A = 1:10, B = c(2,15,6,18,9,7,13,15,10,3), C = c('A','C','A','B','C','D','A','C','D','B'))\n    p = ggplot(dt, aes(x = A, y = B, color = C, group = factor(1))) +\n        geom_point(size = 0.8) +\n        geom_line(size = 0.8) +\n        geom_text(aes(label = B, vjust = 1.1, hjust = -0.5, angle = 45), show_guide = FALSE)   ## add the text about the point\n    myPixel2 <<- GetLine(p)\n    ggsave(\"img/mainPlot2.png\", width = 9, height = 4.6, dpi = 300)   ## Save your ggplot2 plot as a picture.\n\n    filename <- normalizePath(file.path('./img', paste('mainPlot2', '.png', sep = '')))\n    list(src = filename\n         ,width = 800\n         ,height = 400\n    )\n}, deleteFile = FALSE)\n\n\noutput$mainPie <- renderImage({\n    dt = data.frame(A = c(2, 7, 4, 10, 1), B = c('B','A','C','D','E'))\n    p = ggplot(dt, aes(x = \"\", y = A, fill = B)) +\n        geom_bar(stat = \"identity\", width = 1) +\n        coord_polar(theta = \"y\")\n    myAngle1 <<- GetPie(p, names = as.vector(dt$B))\n    ggsave(\"img/mainPlot3.png\", width = 9, height = 4.6, dpi = 300)   ## Save your ggplot2 plot as a picture.\n\n    filename <- normalizePath(file.path('./img', paste('mainPlot3', '.png', sep = '')))\n    list(src = filename\n         ,width = 800\n         ,height = 400\n    )\n}, deleteFile = FALSE)\n\n\noutput$mainRose <- renderImage({\n    dt = data.frame(A = c(2, 7, 4, 10, 1), B = c('B','A','C','D','E'))\n    p = ggplot(dt, aes(x = B, y = A, fill = B)) +\n        geom_bar(stat = \"identity\", alpha = 0.7) +\n        coord_polar()\n    myAngle2 <<- GetRose(p)\n    ggsave(\"img/mainPlot4.png\", width = 9, height = 4.6, dpi = 300)   ## Save your ggplot2 plot as a picture.\n    filename <- normalizePath(file.path('./img', paste('mainPlot4', '.png', sep = '')))\n    list(src = filename\n         ,width = 800\n         ,height = 400\n    )\n}, deleteFile = FALSE)\n\n})\n\n",
    "created" : 1441804520244.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "131135423",
    "id" : "CC75F450",
    "lastKnownWriteTime" : 1440580656,
    "path" : "G:/For_School/集合/其他/行心医疗数据分析系统/myTest/shiny_click_demo/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}